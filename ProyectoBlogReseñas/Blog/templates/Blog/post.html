{% extends "Blog/padre_simple.html" %}

{% load static %}

{% block titulopagina %}  Reseña de <em> {{ post.libro.titulo }}</em>  {% endblock %}

{% block cuerpodelapagina %}

{{ mensaje }}

<h1> {{ post.titulo }} </h1>

<h3>{{ post.subtitulo }}</h3>

<h4>Reseña creada por: <a href="{% url 'profile' post.autor.pk %}">{{ post.autor }} </a> </h4>

{% if post.categoria %}
<p> Categoría: <a href="{% url 'CategoriaPosts' post.categoria|slugify %}"> {{ post.categoria }}</a> </p> 
{% endif %}
<hr>

<h5>Título del libro: <em> {{ post.libro.titulo }} </em> </h5>
<h5>Autor: {{ post.libro.autor }} </h5>
<h5>Editorial: {{ post.libro.editorial }} </h5>
<h5>Año: {{ post.libro.fecha_publicacion}} </h5>
<h5>ISBN: {{ post.libro.isbn }} </h5>



{% if post.libro.imagen %}
<img  src="{{ post.libro.imagen.url }}" width="200" height="200" alt="Tapa de {{post.libro.autor}}">

{% endif %}

<hr>

<p>{{ post.cuerpo|safe }}</p>

{% if request.user == post.autor %}
<p><a href="{% url 'editarPost' post.id %}">Editar reseña </a> |
    <a href="#">Eliminar reseña</a></p>

{% endif %}





<br/>
<hr>
<br/>
<form action="{% url 'like_post' post.pk %}" method="POST">
    {% csrf_token %}

    {% if user.is_authenticated %}    

    {% if not liked %}


    <button type="submit", name="post_id", value="{{ post.id }}", class="btn btn-primary btn-sm">Me gusta</button> 

        
    {% else %}    

    <button type="submit", name="post_id", value="{{ post.id }}", class="btn btn-danger btn-sm">Ya no me gusta</button> 


        
    {% endif %}    

{% else %}
<p> Iniciá sesión para dar "Me gusta" a esta reseña </p>

{% endif %}
    - {{ cantidad_likes }} Me gusta  
</form>

<hr>

<h3>Comentarios</h3>

{% if user.is_authenticated %}

<a href="{% url 'CrearComentario' post.pk  %}">Agregar comentario</a>

{% else %}
<p> Debés iniciar sesión para añadir un cometnario.  </p>
{% endif %}

{% if comentarios %}

{% for comentario in comentarios %}

<hr>

<div data-gb-custom-block data-tag="for"></div>

    <div class="comment">
        <div class="date">{{ comentario.fecha_comentario }}</div>
        <strong>{{ comentario.autor }}</strong>
        <p>{{ comentario.comentario|linebreaks }}</p>
    </div>

<div data-gb-custom-block data-tag="empty">

    {% if request.user == comentario.autor %}

    <div class="links">
    <a href="{% url 'EliminarComentario' comentario.id %}"> Eliminar comentario </a>
</div>

</div>

<hr>


{% endif %}

{% endfor %}


{% else %}
<p> Todavía no hay comentarios en esta reseña. </p>

{% endif %}

{% if user.is_authenticated %}

<a href="{% url 'CrearComentario' post.pk  %}">Agregar comentario</a>

{% else %}
<p> Debés iniciar sesión para añadir un cometnario.  </p>
{% endif %}


{% endblock %}